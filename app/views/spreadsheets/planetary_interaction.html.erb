<h1>Planetary Interaction Spreadsheet</h1>
<h2>Using prices from the <%= @location %></h2>
<% unless @resources.nil? || @materials.nil? %>
  <div class="sub">
    <table class="tablesorter table table-bordered table-striped">
      <thead class="pointer-cursor">
        <tr>
          <th>Resource</th>
          <th>Unit<br/>Price</th>
        </tr>
      </thead>
      <tbody>
        <% @resources.each do |resource| %>
          <tr>
            <td><%= resource[:name] %></td>
            <td><%= resource[:price] %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
  
  <div class="sub">
    <table class="tablesorter table table-bordered table-striped">
      <thead class="pointer-cursor">
        <tr>
          <th>Processed<br/>Material</th>
          <th>Unit<br/>Price</th>
          <th>Processing<br/>Revenue</th>
        </tr>
      </thead>
      <tbody>
        <% @materials.each do |material| %>
          <tr>
            <td><%= material[:name] %></td>
            <td><%= material[:price] %></td>
            <td><%= material[:revenue] %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
  
  <div class="sub">
    <table class="tablesorter table table-bordered table-striped">
      <thead class="pointer-cursor">
        <tr>
          <th>Processed<br/>Material</th>
          <th>Unit<br/>Price</th>
          <th>Processing<br/>Revenue</th>
        </tr>
      </thead>
      <tbody>
        <% @commodities.each do |commoditiy| %>
          <tr>
            <td><%= commoditiy[:name] %></td>
            <td><%= commoditiy[:price] %></td>
            <td><%= commoditiy[:revenue] %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% end %>

<div class="sub">
  <h2 style="margin-top:0">Parameters</h2>
  <%= form_tag spreadsheets_planetary_interaction_path do %>
    <%= label_tag  :region %>
    <%= select_tag :region, options_from_collection_for_select(@regions, :id, :name, @region), :prompt => 'Select Region', :onchange => 'updateSystems()' %>
    <br/><br/>
    <%= label_tag  :system %>
    <% if @systems.nil? %>
      <%= select_tag :system, nil, :prompt => '-' %>
    <% else %>
      <%= select_tag :system, options_from_collection_for_select(@systems, :id, :name, @system), :prompt => 'Whole Region' %>
    <% end %>
    <br/><br/>
    <%= submit_tag 'Calculate' %>
  <% end %>
</div>
<div class="sub">
  <h2>Formulas</h2>
  <h3>Raw Revenues</h3>
  <p>(1000 / O<sub>V</sub>) * P * T</p>
  <p>
    O<sub>V</sub> = Ore Volume<br/>
    P = Ore Price (Sell orders percentile for that ore at the selected region/system)<br/>
    T = 100% - Sale Tax %
  </p>
  <h3>Refining Revenues</h3>
  <p>
    Too lazy to write it right now =p
  </p>
</div>
